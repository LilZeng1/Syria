const translations = {
    en: {
        statText: "1,800+ Members â€” You're the missing one!",
        navHome: "Home",
        navSchedule: "Schedule",
        navReviews: "Family",
        navHeritage: "Heritage",
        navDiscord: "Join Discord",
        heroTitle: "The Heart <br> <span class='italic serif text-levant-gold'>Of The Levant.</span>",
        heroSub: "Forget regular servers. This is where the real ones hang out. From deep talks to gaming chaos, it's just home.",
        enterBtn: "<i class='bx bxl-discord-alt text-xl'></i> Jump In Discord",
        exploreBtn: "Check Events",
        schedTitle: "The Schedule",
        revTitle: "The Family",
        revSupernova: "\"Started from 3 AM calls, now we're a whole tribe. It's more than just a server, it's a sanctuary.\"",
        revAlex: "\"Witnessed every single glow-up. If you want a place with zero fake vibes, this is it. Welcome home.\"",
        revGeorge: "\"I just keep the lights on with some code, but the people here are the real magic. 10/10 vibes only.\"",
        cultTitle: "The <br> Heritage",
        cultSub: "Fairuz in the morning, Wassouf for the soul.",
        cultDesc: "Syria, Lebanon, Jordan, Palestine. Many dialects, one spirit. A bridge between tradition and the digital age.",
        boosterTitle: "Hall of <span class='text-transparent bg-clip-text bg-gradient-to-r from-nitro-pink to-neon-purple'>Legends</span>",
        boosterDesc: "The real MVPs keeping our audio crisp and our streams HD. Respect the badge.",
        galleryTitle: "Moments",
        gallerySub: "Screenshots don't lie",
        faqTitle: "Quick Q<span class='text-levant-gold'>&</span>A",
        faqQ1: "How do I verify?",
        faqA1: `<p class="mb-2">You need to send an application to our staff. You will be asked:</p>
                <ol class="list-decimal list-inside space-y-1 ml-2">
                    <li>What is your country of origin and how old are you?</li>
                    <li>Why do you want to join this server? What do you expect from it?</li>
                    <li>On a scale from 1 to 10, How tolerant are you of opinions that differ from your beliefs?</li>
                </ol>
                <p class="mt-2">If accepted by staff, you're in.</p>`,
        faqQ2: "Are non-Syrians welcome?",
        faqA2: "100%. If you vibe with the culture and respect the rules, you're family."
    },
    ar: {
        statText: "Ø£ÙƒØ«Ø± Ù…Ù† Ù¡Ù¨Ù Ù  Ø¹Ø¶Ùˆ â€” Ø£Ù†Øª Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù†Ø§Ù‚Øµ!",
        navHome: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
        navSchedule: "Ø§Ù„Ø¬Ø¯ÙˆÙ„",
        navReviews: "Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©",
        navHeritage: "Ø§Ù„ØªØ±Ø§Ø«",
        navDiscord: "Ø§Ù†Ø¶Ù… Ø¥Ù„ÙŠÙ†Ø§",
        heroTitle: "Ù‚Ù„Ø¨ <br> <span class='italic serif text-levant-gold'>Ø¨Ù„Ø§Ø¯ Ø§Ù„Ø´Ø§Ù….</span>",
        heroSub: "Ø§Ù†Ø³Ù Ø§Ù„Ø³ÙŠØ±ÙØ±Ø§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©. Ù‡Ù†Ø§ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù„ÙŠ Ø¨ÙŠØ¬Ù…Ø¹Ù†Ø§ Ù…Ù† Ø¬Ø¯. Ù…Ù† Ø§Ù„Ù†Ù‚Ø§Ø´Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ‚Ø© Ù„Ø¬Ù†ÙˆÙ† Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ØŒ Ù‡Ù†Ø§ Ø¨ÙŠØªÙƒ.",
        enterBtn: "<i class='bx bxl-discord-alt text-xl'></i> Ø§Ø¯Ø®Ù„ Ø§Ù„Ø³ÙŠØ±ÙØ±",
        exploreBtn: "Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª",
        schedTitle: "Ø¬Ø¯ÙˆÙ„Ù†Ø§",
        revTitle: "Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©",
        revSupernova: "\"Ø¨Ø¯Ø£Ù†Ø§ Ù…Ù† Ø§ØªØµØ§Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¹Ø© Ù£ Ø§Ù„ØµØ¨Ø­ØŒ ÙˆÙ‡Ù„Ø§ ØµØ±Ù†Ø§ Ù‚Ø¨ÙŠÙ„Ø© ÙƒØ§Ù…Ù„Ø©. Ù…Ùˆ Ù…Ø¬Ø±Ø¯ Ø³ÙŠØ±ÙØ±ØŒ Ù‡Ø§Ø¯ Ù…Ù„Ø¬Ø£Ù†Ø§.\"",
        revAlex: "\"Ø´ÙØª Ø§Ù„Ø³ÙŠØ±ÙØ± ÙˆÙ‡Ùˆ Ø¨ÙŠÙƒØ¨Ø± Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ©. Ø¥Ø°Ø§ Ø¨Ø¯Ùƒ Ù…ÙƒØ§Ù† Ø­Ù‚ÙŠÙ‚ÙŠ Ø¨Ø¯ÙˆÙ† ØªØ²ÙŠÙŠÙØŒ Ù‡Ø§Ø¯ Ù‡Ùˆ Ø§Ù„Ù…ÙƒØ§Ù†. Ø£Ù‡Ù„Ø§Ù‹ ÙÙŠÙƒ.\"",
        revGeorge: "\"Ø£Ù†Ø§ Ø¨Ø³ Ø¨Ù‡ØªÙ… Ø¨Ø§Ù„ÙƒÙˆØ¯ ÙˆØ§Ù„Ø¥Ø¶Ø§Ø¡Ø©ØŒ Ø¨Ø³ Ø§Ù„Ù†Ø§Ø³ Ù‡ÙˆÙ† Ù‡Ù†Ù† Ø§Ù„Ø³Ø­Ø± Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ. Ø£Ø¬ÙˆØ§Ø¡ Ø®ÙŠØ§Ù„ÙŠØ© Ù¡Ù /Ù¡Ù .\"",
        cultTitle: "Ø§Ù„ØªØ±Ø§Ø« <br> Ø§Ù„Ø¹Ø±ÙŠÙ‚",
        cultSub: "ÙÙŠØ±ÙˆØ² Ø¨Ø§Ù„ØµØ¨Ø­ØŒ ÙˆØ§Ù„ÙˆØ³ÙˆÙ Ù„Ù„Ø±ÙˆØ­.",
        cultDesc: "Ø³ÙˆØ±ÙŠØ§ØŒ Ù„Ø¨Ù†Ø§Ù†ØŒ Ø§Ù„Ø£Ø±Ø¯Ù†ØŒ ÙÙ„Ø³Ø·ÙŠÙ†. Ù„Ù‡Ø¬Ø§Øª ÙƒØªÙŠØ±Ø©ØŒ Ø¨Ø³ Ø§Ù„Ø±ÙˆØ­ ÙˆØ­Ø¯Ø©. Ø¬Ø³Ø± Ø¨ÙŠÙ† Ø§Ù„Ø£ØµØ§Ù„Ø© ÙˆØ§Ù„Ø¹ØµØ± Ø§Ù„Ø±Ù‚Ù…ÙŠ.",
        boosterTitle: "Ù‚Ø§Ø¹Ø© <span class='text-transparent bg-clip-text bg-gradient-to-r from-nitro-pink to-neon-purple'>Ø§Ù„Ø£Ø³Ø§Ø·ÙŠØ±</span>",
        boosterDesc: "Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø°Ù‡Ø¨ÙŠÙŠÙ† Ø§Ù„Ù„ÙŠ Ù…Ø®Ù„ÙŠÙŠÙ† Ø§Ù„ØµÙˆØª ÙˆØ§Ø¶Ø­ ÙˆØ§Ù„Ø¨Ø« Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¯Ù‚Ø©. ÙƒÙ„ Ø§Ù„Ø§Ø­ØªØ±Ø§Ù….",
        galleryTitle: "Ù„Ø­Ø¸Ø§Øª",
        gallerySub: "ØµÙˆØ± Ù„Ù„Ø°ÙƒØ±Ù‰",
        faqTitle: "Ø³Ø¤Ø§Ù„ <span class='text-levant-gold'>Ùˆ</span> Ø¬ÙˆØ§Ø¨",
        faqQ1: "ÙƒÙŠÙ Ø¨ÙˆØ«Ù‚ Ø­Ø³Ø§Ø¨ÙŠØŸ",
        faqA1: `<p class="mb-2">Ù„Ø§Ø²Ù… ØªÙ‚Ø¯Ù… Ø·Ù„Ø¨ Ù„Ù„Ø§Ø¯Ø§Ø±Ø©ØŒ Ø±Ø­ ØªÙ†Ø³Ø£Ù„:</p>
                <ol class="list-decimal list-inside space-y-1 ml-2">
                    <li>Ù…Ø§ Ù‡Ùˆ Ø¨Ù„Ø¯Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ ÙˆÙƒÙ… Ø¹Ù…Ø±ÙƒØŸ</li>
                    <li>Ù„Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø®Ø§Ø¯Ù…ØŸ ÙˆÙ…Ø§Ø°Ø§ ØªØªÙˆÙ‚Ø¹ Ù…Ù†Ù‡ØŸ</li>
                    <li>Ø¹Ù„Ù‰ Ù…Ù‚ÙŠØ§Ø³ Ù…Ù† 1 Ø¥Ù„Ù‰ 10ØŒ Ù…Ø§ Ù…Ø¯Ù‰ ØªØ³Ø§Ù…Ø­Ùƒ Ù…Ø¹ Ø§Ù„Ø¢Ø±Ø§Ø¡ Ø§Ù„ØªÙŠ ØªØ®ØªÙ„Ù Ø¹Ù† Ù…Ø¹ØªÙ‚Ø¯Ø§ØªÙƒØŸ</li>
                </ol>
                <p class="mt-2">Ø§Ø°Ø§ ÙˆØ§ÙÙ‚ÙˆØ§ Ø¹Ù„ÙŠÙƒØŒ Ù…Ø¨Ø±ÙˆÙƒ ØµØ±Øª Ù…Ù†Ø§.</p>`,
        faqQ2: "Ù‡Ù„ Ù…Ø³Ù…ÙˆØ­ Ù„ØºÙŠØ± Ø§Ù„Ø³ÙˆØ±ÙŠÙŠÙ†ØŸ",
        faqA2: "Ø£ÙƒÙŠØ¯ Ù¡Ù Ù Ùª. Ø·Ø§Ù„Ù…Ø§ Ø¨ØªØ­ØªØ±Ù… Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† ÙˆØ§Ù„Ø¬Ùˆ Ø§Ù„Ø¹Ø§Ù…ØŒ Ø£Ù†Øª Ù…Ù† Ø§Ù„Ø¹ÙŠÙ„Ø©."
    }
};

let currentLang = 'en';

function toggleMenu() {
    const menu = document.getElementById('mobile-menu');
    const isOpen = menu.style.transform === 'translateX(0%)';
    menu.style.transform = isOpen ? 'translateX(100%)' : 'translateX(0%)';
}

document.getElementById('open-menu').addEventListener('click', toggleMenu);
document.getElementById('close-menu').addEventListener('click', toggleMenu);

window.addEventListener('load', () => {
    setTimeout(() => {
        document.getElementById('loader').classList.add('hidden-loader');
        reveal();
        initStarfield();
        startLiveFeed();
        initTilt();
    }, 1000);
});

function updateLanguage() {
    const t = translations[currentLang];
    document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
    document.body.style.opacity = '0';

    setTimeout(() => {
        document.getElementById('stat-text').innerText = t.statText;
        document.getElementById('hero-title').innerHTML = t.heroTitle;
        document.getElementById('hero-sub').innerText = t.heroSub;
        document.getElementById('enter-btn').innerHTML = t.enterBtn;
        document.getElementById('explore-btn').innerText = t.exploreBtn;
        document.getElementById('sched-title').innerText = t.schedTitle;
        document.getElementById('rev-title').innerText = t.revTitle;
        document.getElementById('rev-supernova').innerText = t.revSupernova;
        document.getElementById('rev-alex').innerText = t.revAlex;
        document.getElementById('rev-george').innerText = t.revGeorge;
        document.getElementById('cult-title').innerHTML = t.cultTitle;
        document.getElementById('cult-sub').innerText = t.cultSub;
        document.getElementById('cult-desc').innerText = t.cultDesc;
        document.getElementById('booster-title').innerHTML = t.boosterTitle;
        document.getElementById('booster-desc').innerText = t.boosterDesc;
        document.getElementById('gallery-title').innerText = t.galleryTitle;
        document.getElementById('gallery-sub').innerText = t.gallerySub;
        document.getElementById('faq-title').innerHTML = t.faqTitle;
        document.getElementById('faq-q1').innerText = t.faqQ1;
        document.getElementById('faq-a1').innerHTML = t.faqA1;
        document.getElementById('faq-q2').innerText = t.faqQ2;
        document.getElementById('faq-a2').innerText = t.faqA2;

        document.body.style.opacity = '1';
        reveal();
    }, 400);
}

document.getElementById('lang-toggle').addEventListener('click', () => {
    currentLang = currentLang === 'en' ? 'ar' : 'en';
    updateLanguage();
});

document.getElementById('lang-toggle-mob').addEventListener('click', () => {
    currentLang = currentLang === 'en' ? 'ar' : 'en';
    updateLanguage();
    setTimeout(toggleMenu, 600);
});

function reveal() {
    const reveals = document.querySelectorAll('.reveal');
    reveals.forEach(el => {
        const windowHeight = window.innerHeight;
        const revealTop = el.getBoundingClientRect().top;
        const revealPoint = 80;
        if (revealTop < windowHeight - revealPoint) {
            el.classList.add('active');
        }
    });
}

window.addEventListener('scroll', reveal);

const modal = document.getElementById('upload-modal');
const btn = document.getElementById('upload-btn');
const close = document.getElementById('close-upload');
const dropZone = document.getElementById('drop-zone');
const fileInput = document.getElementById('file-input');
const previewContainer = document.getElementById('preview-container');
const imagePreview = document.getElementById('image-preview');
const submitBtn = document.getElementById('submit-upload');

function openModal() {
    modal.classList.remove('hidden');
    setTimeout(() => {
        modal.classList.remove('opacity-0');
        document.getElementById('upload-content').classList.remove('scale-95');
    }, 10);
}

function closeModal() {
    modal.classList.add('opacity-0');
    document.getElementById('upload-content').classList.add('scale-95');
    setTimeout(() => {
        modal.classList.add('hidden');
        resetForm();
    }, 300);
}

function resetForm() {
    fileInput.value = '';
    previewContainer.classList.add('hidden');
    imagePreview.src = '';
}

btn.addEventListener('click', openModal);
close.addEventListener('click', closeModal);
modal.addEventListener('click', (e) => {
    if (e.target === modal) closeModal();
});

fileInput.addEventListener('change', function () {
    const file = this.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
            imagePreview.src = e.target.result;
            previewContainer.classList.remove('hidden');
        }
        reader.readAsDataURL(file);
    }
});

submitBtn.addEventListener('click', () => {
    if (!fileInput.files[0]) return;

    const newCard = document.createElement('div');
    newCard.className = 'break-inside-avoid glass-card rounded-2xl p-2 group hover:rotate-2 transition-transform duration-300 reveal active';
    newCard.innerHTML = `
        <div class="bg-gray-800 rounded-xl overflow-hidden aspect-video relative">
            <img src="${imagePreview.src}" class="w-full h-full object-cover">
            <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                 <span class="text-[10px] font-black uppercase tracking-widest text-white">Just Now</span>
            </div>
        </div>
    `;

    document.getElementById('gallery-grid').prepend(newCard);
    closeModal();
});

function initStarfield() {
    const canvas = document.getElementById('starfield');
    const ctx = canvas.getContext('2d');
    let width, height;
    let stars = [];
    const maxStars = 100;

    function resize() {
        width = window.innerWidth;
        height = window.innerHeight;
        canvas.width = width;
        canvas.height = height;
    }

    function Star() {
        this.x = Math.random() * width;
        this.y = Math.random() * height;
        this.vx = (Math.random() - 0.5) * 0.5;
        this.vy = (Math.random() - 0.5) * 0.5;
        this.size = Math.random() * 2;
    }

    Star.prototype.update = function () {
        this.x += this.vx;
        this.y += this.vy;
        if (this.x < 0) this.x = width;
        if (this.x > width) this.x = 0;
        if (this.y < 0) this.y = height;
        if (this.y > height) this.y = 0;
    }

    Star.prototype.draw = function () {
        ctx.fillStyle = 'rgba(212, 175, 55, ' + (Math.random() * 0.5 + 0.3) + ')';
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
    }

    for (let i = 0; i < maxStars; i++) stars.push(new Star());

    let mouse = { x: 0, y: 0 };
    window.addEventListener('mousemove', (e) => {
        mouse.x = e.clientX;
        mouse.y = e.clientY;
    });

    function animate() {
        ctx.clearRect(0, 0, width, height);
        stars.forEach(star => {
            star.update();
            star.draw();

            let dx = mouse.x - star.x;
            let dy = mouse.y - star.y;
            let distance = Math.sqrt(dx * dx + dy * dy);
            if (distance < 150) {
                ctx.strokeStyle = `rgba(212, 175, 55, ${1 - distance / 150})`;
                ctx.lineWidth = 0.5;
                ctx.beginPath();
                ctx.moveTo(star.x, star.y);
                ctx.lineTo(mouse.x, mouse.y);
                ctx.stroke();
            }
        });
        requestAnimationFrame(animate);
    }

    window.addEventListener('resize', resize);
    resize();
    animate();
}

const mockEvents = [
    { type: 'join', text: 'Sarah just joined the server!' },
    { type: 'boost', text: 'Ahmed boosted the server! ğŸš€' },
    { type: 'vc', text: 'Gaming VC is active (12 users)' },
    { type: 'music', text: 'Music Bot is playing Fairuz' },
    { type: 'event', text: 'Movie Night starting in 15m' }
];

function startLiveFeed() {
    const container = document.getElementById('live-activity');
    if (!container) return;

    setInterval(() => {
        const event = mockEvents[Math.floor(Math.random() * mockEvents.length)];
        const el = document.createElement('div');
        el.className = 'glass-card px-4 py-2 rounded-full text-[10px] font-bold uppercase tracking-widest border border-white/10 flex items-center gap-2 notification-enter shadow-xl bg-black/80';
        let icon = '';
        if (event.type === 'join') icon = '<i class="bx bxs-user-plus text-green-400"></i>';
        if (event.type === 'boost') icon = '<i class="bx bxs-rocket text-pink-500"></i>';
        if (event.type === 'vc') icon = '<i class="bx bxs-microphone text-blue-400"></i>';
        if (event.type === 'music') icon = '<i class="bx bxs-music text-purple-400"></i>';
        if (event.type === 'event') icon = '<i class="bx bxs-calendar text-yellow-500"></i>';

        el.innerHTML = `${icon} <span>${event.text}</span>`;

        container.appendChild(el);
        if (container.children.length > 3) {
            container.removeChild(container.firstChild);
        }

        setTimeout(() => {
            el.classList.remove('notification-enter');
            el.classList.add('notification-exit');
            setTimeout(() => el.remove(), 500);
        }, 4000);
    }, 5000);
}

let isPlaying = false;
const playerBtn = document.getElementById('music-player');
const playIcon = document.getElementById('play-icon');
const eq = document.getElementById('eq-viz');
const cover = document.getElementById('music-cover');

if (playerBtn) {
    playerBtn.addEventListener('click', () => {
        isPlaying = !isPlaying;
        if (isPlaying) {
            playIcon.className = 'bx bx-pause text-xl';
            eq.classList.remove('opacity-0');
            cover.classList.add('animate-spin-slow');
            cover.style.animation = 'spin 4s linear infinite';
        } else {
            playIcon.className = 'bx bx-play text-xl';
            eq.classList.add('opacity-0');
            cover.style.animation = 'none';
        }
    });
}

function initTilt() {
    const cards = document.querySelectorAll('.tilt-card');

    cards.forEach(card => {
        card.addEventListener('mousemove', (e) => {
            const rect = card.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            const centerX = rect.width / 2;
            const centerY = rect.height / 2;

            const rotateX = ((y - centerY) / centerY) * -5;
            const rotateY = ((x - centerX) / centerX) * 5;

            card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
        });

        card.addEventListener('mouseleave', () => {
            card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0)';
        });
    });
}

const counters = document.querySelectorAll('.counter');
const speed = 200;

const animateCounters = () => {
    counters.forEach(counter => {
        const updateCount = () => {
            const target = +counter.getAttribute('data-target');
            const count = +counter.innerText;
            const inc = target / speed;

            if (count < target) {
                counter.innerText = Math.ceil(count + inc);
                setTimeout(updateCount, 1);
            } else {
                counter.innerText = target + "+";
            }
        };
        updateCount();
    });
}

let counted = false;
window.addEventListener('scroll', () => {
    const statsSection = document.getElementById('stats');
    if (statsSection && window.scrollY + window.innerHeight > statsSection.offsetTop && !counted) {
        animateCounters();
        counted = true;
    }
});
